이전

function GetWeather() {
const navigate = useNavigate();

// interface 정의
interface WeatherType {
name: string;
main: {
temp: number;
};
weather: {
main: any;
description: string;
icon: string;
}[];
}

// [상태관리1]: WeatherData
const [weatherData, setWeatherData] = useState<WeatherType | null>(null);

// WeathefData 없는 경우
if (!weatherData) {
return (

<div className={styles.loadingPg}>날씨에 어울리는 칵테일 제조중...</div>
);
}

// weather api 통신 및 setWeatherData 처리
useEffect(() => {
const getCurrentWeather = async () => {
try {
const position = await getLocation();
const { latitude, longitude } = position.coords;

        const weatherData = await fetchWeatherData(latitude, longitude);
        setWeatherData(weatherData);
      } catch (error) {
        console.error('Error:', error);
      }
    };
    getCurrentWeather();

}, []);

// 저장한 상태 재료 가져와서 쓰기
// name: 현재 지역명, weather를 weatherDetails 이름으로 바꿔 가져오기, desc: 날씨(국문)
const { name, main, weather: weatherDetails } = weatherData;
const temperature = `${main.temp.toFixed(0)} °C`;
const { description, icon } = weatherDetails[0];
const iconUrl = `http://openweathermap.org/img/wn/${icon}.png`;

// 주소별 조회버튼
const handleLocationBtnClick = () => {
navigate(`/weather`);
};

// getWeather 컴포넌트 리턴 값
return (

<div>
<h3 className={styles.h3}>현재 위치한 곳의 날씨</h3>
<h3 className={styles.h3}>{name}</h3>
<button onClick={handleLocationBtnClick} className={styles.locationBtn}>
주소별 칵테일 조회하러가기
</button>
<p className={styles.p}>
날씨 : {description} | {temperature}{' '}
</p>

      <div className={styles.weatherIcons}>
        <img
          src={iconUrl}
          alt="Weather Icon"
          className={styles.weatherIcon}
        ></img>
        <img
          src={iconUrl}
          alt="Weather Icon"
          className={styles.weatherIcon}
        ></img>
        <img
          src={iconUrl}
          alt="Weather Icon"
          className={styles.weatherIcon}
        ></img>
      </div>
      <h3 className={styles.h3}>[{description}] 날씨에 어울리는 칵테일</h3>
    </div>

);
}

[문제]
https://velog.io/@jazzyfact95/TIL-React-React-Hook-is-called-conditionally.-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0

이후
useeffect를 최상위로 올려주니 문제 해결

[메모]
weatherData 데이터 형식 참고

[문제2]
데이터가 서버 등 오류로 인해 못들어 오는 경우도 있으니까
ts 타입을 null 추가해주기
const [weatherInfo, setWeatherInfo] = useState<WeatherType | null>(null);
